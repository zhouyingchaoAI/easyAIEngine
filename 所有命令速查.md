# 🚀 所有命令速查表

## 启动服务

```bash
# Web管理界面（端口 7901）
./start_manager.sh

# 实时检测服务（端口 7902）
./start_algorithm_service.sh

# 绊线统计服务（端口 7903）
./start_line_crossing_service.sh

# 带GPU配置启动
./start_algorithm_service.sh --gpu-id 0 --port 7902
./start_line_crossing_service.sh --gpu-id 1 --port 7903
```

---

## 停止服务

```bash
# 停止所有服务（推荐）
./停止所有服务.sh

# 单独停止
pkill -f algorithm_service.py
pkill -f algorithm_service_line_crossing.py
pkill -f algorithm_manager.py
```

---

## 日志管理

```bash
# 实时查看日志
./manage_logs.sh view realtime      # 实时检测
./manage_logs.sh view line          # 绊线统计
./manage_logs.sh view manager       # 管理器
./manage_logs.sh view all           # 全部

# 查看最后N行
./manage_logs.sh tail realtime 200
./manage_logs.sh tail line 500

# 日志统计
./manage_logs.sh stats

# 搜索日志
./manage_logs.sh search "ERROR"
./manage_logs.sh search "穿越"

# 清空日志
./manage_logs.sh clear realtime
./manage_logs.sh clear all

# 备份日志
./manage_logs.sh backup
```

---

## 服务检查

```bash
# 检查服务状态
curl http://localhost:7901          # Web管理界面
curl http://localhost:7902/health   # 实时检测
curl http://localhost:7903/health   # 绊线统计

# 查看服务进程
ps aux | grep algorithm_service

# 查看端口占用
netstat -tulpn | grep 790
lsof -i:7901
lsof -i:7902
lsof -i:7903
```

---

## GPU监控

```bash
# 查看GPU状态
nvidia-smi

# 实时监控
watch -n 1 nvidia-smi

# 查看显存使用
nvidia-smi --query-gpu=memory.used,memory.total --format=csv
```

---

## 配置文件

```bash
# 查看配置文件
ls -l /cv_space/predict/configs/

# 查看配置内容
cat /cv_space/predict/configs/厕所统计_algo_config.json

# 编辑配置
vi /cv_space/predict/configs/测试统计_algo_config.json
```

---

## 测试接口

```bash
# 测试实时检测服务
curl -X POST http://localhost:7902/infer \
  -H "Content-Type: application/json" \
  -d '{
    "image_url": "http://your-server/image.jpg",
    "task_id": "测试",
    "task_type": "人数统计"
  }'

# 测试绊线统计服务
curl -X POST http://localhost:7903/infer \
  -H "Content-Type: application/json" \
  -d '{
    "image_url": "http://your-server/image.jpg",
    "task_id": "门禁",
    "task_type": "绊线人数统计"
  }'
```

---

## 文档查看

```bash
# 查看快速开始
cat 快速开始.md

# 查看端口配置
cat 端口速查.txt

# 查看所有文档
ls -l *.md
```

---

## 常用组合

### 完整启动流程

```bash
# 1. 启动Web管理界面
./start_manager.sh &

# 2. 等待3秒
sleep 3

# 3. 访问界面启动算法服务
# http://localhost:7901
```

### 重启服务

```bash
# 停止所有
./停止所有服务.sh

# 等待
sleep 2

# 重新启动
./start_algorithm_service.sh --gpu-id 0 &
./start_line_crossing_service.sh --gpu-id 1 &
```

### 查看服务状态

```bash
# 一次性查看所有信息
echo "=== 进程状态 ==="
ps aux | grep algorithm_service

echo ""
echo "=== 端口状态 ==="
netstat -tulpn | grep 790

echo ""
echo "=== GPU状态 ==="
nvidia-smi

echo ""
echo "=== 日志统计 ==="
./manage_logs.sh stats
```

---

## 快捷别名（可选）

在 `~/.bashrc` 中添加：

```bash
# 算法服务管理别名
alias algo-ui='cd /cv_space/predict && ./start_manager.sh'
alias algo-start='cd /cv_space/predict && ./start_algorithm_service.sh'
alias algo-line='cd /cv_space/predict && ./start_line_crossing_service.sh'
alias algo-stop='cd /cv_space/predict && ./停止所有服务.sh'
alias algo-logs='cd /cv_space/predict && ./manage_logs.sh'
alias algo-status='curl http://localhost:7902/health && curl http://localhost:7903/health'
```

使用：
```bash
algo-ui         # 启动管理界面
algo-start      # 启动实时检测
algo-line       # 启动绊线统计
algo-stop       # 停止所有服务
algo-logs view  # 查看日志
algo-status     # 检查服务状态
```

---

Happy managing! 🎉

