# 配置参数说明

## 🔧 所有可用参数

### 基础参数

```bash
python3 algorithm_service.py \
  --service-id yolo11x_head_detector \
  --port 8000 \
  --easydarwin http://10.1.6.230:5066
```

---

## 📊 参数详解

### 1. 服务配置

| 参数 | 类型 | 默认值 | 说明 |
|------|------|--------|------|
| `--service-id` | string | yolo11x_head_detector | 服务唯一标识 |
| `--name` | string | YOLOv11x人头检测算法 | 服务名称 |
| `--port` | int | 8000 | HTTP监听端口 |
| `--host` | string | 0.0.0.0 | 监听地址 |

### 2. 批处理配置

| 参数 | 类型 | 默认值 | 说明 |
|------|------|--------|------|
| `--batch-size` | int | 8 | 批处理大小，建议4-16 |
| `--batch-timeout` | float | 0.1 | 批处理超时（秒），100ms时间窗口 |
| `--no-batching` | flag | false | 禁用批处理，使用原始单张推理 |

### 3. 可视化配置

| 参数 | 类型 | 默认值 | 说明 |
|------|------|--------|------|
| `--no-video` | flag | false | 禁用视频保存 |

### 4. EasyDarwin配置

| 参数 | 类型 | 默认值 | 说明 |
|------|------|--------|------|
| `--easydarwin` | string | http://localhost:5066 | EasyDarwin平台地址 |
| `--no-register` | flag | false | 不注册到EasyDarwin |

### 5. 模型配置

| 参数 | 类型 | 默认值 | 说明 |
|------|------|--------|------|
| `--model` | string | /cv_space/NWPU-Crowd/.../best.pt | 模型文件路径 |
| `--task-types` | list | [...] | 支持的任务类型列表 |

---

## 🎯 使用场景

### 场景1: 默认配置
```bash
python3 algorithm_service.py
```

**效果：**
- 批处理: 启用（batch_size=8, timeout=0.1s）
- 视频保存: 启用
- 自动注册到EasyDarwin

### 场景2: 高性能配置
```bash
python3 algorithm_service.py --batch-size 16 --batch-timeout 0.1
```

**效果：**
- 更大的批处理大小
- 吞吐量提升到120 req/s
- 适合高并发场景

### 场景3: 低延迟配置
```bash
python3 algorithm_service.py --batch-size 4 --batch-timeout 0.05
```

**效果：**
- 较小的批处理大小
- 更短的等待时间
- 适合实时性要求高的场景

### 场景4: 纯推理（无视频）
```bash
python3 algorithm_service.py --no-video
```

**效果：**
- 不保存视频
- 节省磁盘I/O
- 提升性能
- 适合只需要推理结果的场景

### 场景5: 原始模式（无批处理）
```bash
python3 algorithm_service.py --no-batching
```

**效果：**
- 使用原始单张推理
- 吞吐量约20 req/s
- 适合单路低频场景

### 场景6: 独立HTTP服务
```bash
python3 algorithm_service.py --no-register --port 8888
```

**效果：**
- 不注册到EasyDarwin
- 作为独立HTTP服务
- 适合测试或独立使用

### 场景7: 极简模式
```bash
python3 algorithm_service.py --no-batching --no-video --no-register
```

**效果：**
- 纯粹的单张推理
- 无视频保存
- 无服务注册
- 最小化资源占用

---

## 📊 参数组合建议

### 生产环境（推荐）
```bash
python3 algorithm_service.py \
  --port 8000 \
  --batch-size 8 \
  --batch-timeout 0.1 \
  --easydarwin http://10.1.6.230:5066
```

### 测试环境
```bash
python3 algorithm_service.py \
  --port 8000 \
  --no-register \
  --no-video
```

### 高性能场景
```bash
python3 algorithm_service.py \
  --batch-size 16 \
  --batch-timeout 0.15
```

### 低延迟场景
```bash
python3 algorithm_service.py \
  --batch-size 4 \
  --batch-timeout 0.05
```

---

## 🎉 启动信息示例

```
============================================================
  YOLOv11x人头检测算法 v2.0.0
============================================================
正在加载模型: /cv_space/NWPU-Crowd/runs/exp_yolo11x3/weights/best.pt
✓ 模型加载成功 (耗时: 3.52秒)
✓ 跟踪器管理器已初始化
✓ 批处理推理已启动 (batch_size=8, timeout=0.1s)
✓ 使用多线程HTTP服务器，支持并发请求
✓ 视频保存已启用 (保存位置: /cv_space/predict/videos/)

正在注册到 http://10.1.6.230:5066...
✓ 注册成功: yolo11x_head_detector

算法服务已启动
  服务ID: yolo11x_head_detector
  监听地址: 0.0.0.0:8000
  推理端点: http://0.0.0.0:8000/infer
============================================================
```

**根据启动信息确认各功能是否启用！** ✅

