# algorithm_manager.py 打包使用说明

## 📦 打包方法

### 方法1: 使用打包脚本（推荐）

```bash
cd /code/predict
./build.sh --manager-only
```

### 方法2: 直接使用PyInstaller

```bash
cd /code/predict
pyinstaller --clean build_manager.spec
```

## 📁 输出位置

打包完成后，可执行文件位于：
```
dist/algorithm_manager
```

## ✅ 打包结果

- **文件大小**: 约14MB
- **文件类型**: ELF 64-bit LSB executable (ARM aarch64)
- **包含内容**: 
  - Python解释器和所有依赖库
  - algorithm_manager.py 源代码
  - configs/ 配置文件目录

## 🚀 使用方法

### 运行可执行文件

```bash
./dist/algorithm_manager
```

### 查看帮助（如果支持）

```bash
./dist/algorithm_manager --help
```

## 📋 打包配置说明

配置文件: `build_manager.spec`

### 主要配置项

1. **包含的文件**:
   - `algorithm_manager.py` (主程序)
   - `configs/` (配置文件目录)

2. **隐藏导入**:
   - flask
   - flask_cors
   - psutil
   - requests
   - werkzeug
   - jinja2

3. **打包选项**:
   - `console=True`: 显示控制台窗口
   - `upx=True`: 使用UPX压缩（如果可用）

## ⚠️ 注意事项

1. **系统架构**: 
   - 当前打包为 ARM aarch64 架构
   - 只能在相同架构的系统上运行

2. **依赖库**:
   - 可执行文件已包含所有Python依赖
   - 系统级别的库（如昇腾ACL）需要在目标机器上单独安装

3. **配置文件**:
   - `configs/` 目录已包含在可执行文件中
   - 运行时会在临时目录中解压

4. **端口和网络**:
   - 确保目标机器上的端口可用
   - 确保网络连接正常

## 🔧 故障排查

### 如果可执行文件无法运行

1. **检查文件权限**:
   ```bash
   chmod +x dist/algorithm_manager
   ```

2. **检查系统架构**:
   ```bash
   file dist/algorithm_manager
   uname -m
   ```

3. **查看错误信息**:
   ```bash
   ./dist/algorithm_manager 2>&1 | tee error.log
   ```

### 如果缺少依赖

1. **检查系统库**:
   - 确保昇腾ACL库已安装
   - 确保其他系统依赖已安装

2. **重新打包**:
   - 如果添加了新的依赖，需要重新打包

## 📝 更新打包

如果修改了代码，重新打包：

```bash
cd /code/predict
pyinstaller --clean build_manager.spec
```

或者使用脚本：

```bash
./build.sh --manager-only
```

---

**最后更新**: 2025-11-13

